<style scoped>.label {    display: inline-block;    width: 300px;}.label__button {    text-align: center;    border: 1px solid #eee;    height: 50px;    line-height: 50px;    display: block;}#input { display: none }.upload {    margin: 20px 0;    padding: 20px 0;}.upload__image {    width: 200px;    height: auto;}.loading {    background: #efefef;    font-size: 30px;    width: 300px;    height: 300px;    text-align: center;    line-height: 300px;}</style><template>    <div id='upload'>        <label for='input' class='label'>            <span class='label__button'>点击上传图片, 生成hash</span>            <input type='file'                   id='input'                   @change='handleUploadImage'            />        </label>        <div class='upload' v-show='!loading && src' >            <img :src='src' alt='upload-image' class='upload__image'>        </div>        <div v-show='loading' class='loading'>encode...</div>    </div></template><script>import { encode } from 'blurhash';const loadImage = async (src) =>    new Promise((resolve, reject) => {        const img = new Image();        img.onload = () => resolve(img);        img.onerror = (error) => console.log('image load error =>', error);        img.src = src;    });const getImageData = (image, id) => {    const canvas = document.createElement('canvas');    canvas.width = image.width;    canvas.height = image.height;    const context = canvas.getContext('2d');    context.drawImage(image, 0, 0);    return context.getImageData(0, 0, image.width, image.height);};export default {    data: () => ({        src: '',        loading: false,    }),    methods: {        handleUploadImage(e) {            const fs = e.target.files[0];            if (!fs.type.includes('image')) return;            this.loading = true;            const fileReader = new FileReader()            fileReader.onload = (e) => this.base64ImageToBlurHash(e, fs.name);            fileReader.readAsDataURL(fs);        },        async base64ImageToBlurHash(e, id) {            const base64 = e.target.result;            this.src = base64;            const image = await loadImage(base64);            const { data, width, height } = getImageData(image, id);            const hash = encode(data, width, height, 3, 3);            this.$emit('encode', {                id,                hash,                width,                height,            })            this.loading = false;        },    },};</script>